#!/bin/sh

BUILD_DIR=$1

echo "-----> Installing dotenvx..."

# Determine platform and architecture
PLATFORM=$(uname)
ARCH=$(uname -m)

# Create a directory for dotenvx binary
DOTENVX_BIN_DIR="$BUILD_DIR/bin"
mkdir -p $DOTENVX_BIN_DIR

# Download and extract dotenvx binary
curl -fsSL "https://dotenvx.sh/$PLATFORM/$ARCH".tgz | tar xz -C $DOTENVX_BIN_DIR

# test binary and output help
dotenvx help

# Optionally, add dotenvx binary directory to PATH for subsequent buildpacks or scripts
export PATH="$DOTENVX_BIN_DIR:$PATH"

echo "-----> dotenvx installation completed"
